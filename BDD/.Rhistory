??runif
runif(5, 1, 2)
?runif
par = runif(50, 0, 1)^(-1/3)
par
?hist
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
tau = 3
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(2)
tau = 3
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
tau = 3
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
tau = 3
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
tau = 3
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
par = runif(50, 0, 1)^(-1/3)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(4)
tau = 3
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
set.seed(1)
tau = 3
par = runif(50, 0, 1)^(-1/tau)
hist(par, probability = TRUE)
curve(tau/(x^(tau+1)), add = TRUE)
?sum*
?sum
?log
t = sum(log(par))
Tau_0 = 3
?qgamma
alpha = 0.05
q = qgamma(alpha, shape = n, scale = 1)
n = 50
q = qgamma(alpha, shape = n, scale = 1)
k = (1/Tau_0)*q
reject = (t < k)
?qnorm
q_norm = qnorm(1 - alpha, mean = 0, sd = 1)
?sqrt
k_norm = Tau_0*(1 + (q_norm/sqrt(n)))
t_ga = sum(log(par))
t_norm = n/t_ga
reject_norm = (t_norm > k_norm)
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
B = 100
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE)
B = 1000
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE)
B = 10000
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE)
?hist
B = 10000
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE, breaks = 100)
B = 100
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE)
q_bi_1 = qgamma(1-(alpha/2), shape = n, scale = 1)
q_bi_1 = qgamma(alpha/2, shape = n, scale = 1)
q_bi_1 = qgamma(1-(alpha/2), shape = n, scale = 1)
q_bi_2 = qgamma(alpha/2, shape = n, scale = 1)
k_bi_1 = (1/Tau_1)*q_bi_1
k_bi_2 = (1/Tau_0)*q_bi_2
Tau_1 = 1
k_bi_1 = (1/Tau_1)*q_bi_1
k_bi_2 = (1/Tau_0)*q_bi_2
reject_bi = (t_ga < q_bi_2 | t_ga > q_bi_1)
reject_bi = (t_ga < k_bi_2 | t_ga > k_bi_1)
niveau_ga = sum((n/Tchap < k_ga))/B
k_ga = (1/Tau_0)*q_ga
q_ga = qgamma(alpha, shape = n, scale = 1)
t_ga = sum(log(par)) # ~= 14,6
k_ga = (1/Tau_0)*q_ga
niveau_ga = sum((n/Tchap < k_ga))/B
B = 10000
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE)
niveau_ga = sum((n/Tchap < k_ga))/B
B = 100000
set.seed(1)
Tchap = replicate(B, 1/mean( log(runif(n)^(-1/tau) ) ) )
hist(Tchap, probability = TRUE)
niveau_ga = sum((n/Tchap < k_ga))/B
?qgamma
dgamma(1, shape = 50, scale = 1)
dgamma(18, shape = 50, scale = 1)
dgamma(50, shape = 50, scale = 1)
dgamma(80, shape = 50, scale = 1)
dgamma(150, shape = 50, scale = 1)
pgamma(1, shape = 50, scale = 1)
pgamma(30, shape = 50, scale = 1)
pgamma(50, shape = 50, scale = 1)
pgamma(80, shape = 50, scale = 1)
pgamma(100, shape = 50, scale = 1)
?curve
curve(pgamma(x/Tau_0, shape = 50, scale = 1), from = 2, to = 5)
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = 2, to = 5)
?abline
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = 2, to = 5)
abline(a = 0.05)
?abline
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = 2, to = 5)
abline(a = 0.05, b = 0)
?for
return
?return
?curve
?points
?lines
sim_p_ga = function(prv_Tau_0, prv_tau, prv_n, prv_B, prv_alpha){
prv_q_ga = qgamma(prv_alpha, shape = prv_n, scale = 1)
prv_k_ga = (1/prv_Tau_0)*prv_q_ga
prv_Tchap = replicate(prv_B, 1/mean( log(runif(prv_n)^(-1/prv_tau) ) ) )
puiss = sum((prv_n/prv_Tchap < prv_k_ga))/prv_B
return(puiss)
}
sim_p_norm = function(prv_Tau_0, prv_tau, prv_n, prv_B, prv_alpha){
prv_q_norm = qnorm(1 - prv_alpha, mean = 0, sd = 1)
prv_k_norm = prv_Tau_0*(1 + (prv_q_norm/sqrt(prv_n)))
prv_Tchap = replicate(prv_B, 1/mean( log(runif(prv_n)^(-1/prv_tau) ) ) )
puiss = sum((prv_Tchap > prv_k_norm))/prv_B
}
beg = 2
end = 5
?points
?points
schritt = 0.01
N = (end - beg)/schritt
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = beg, to = end)
abline(a = 0.05, b = 0)
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
B = 100
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = beg, to = end)
abline(a = 0.05, b = 0)
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
?plot
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
?plot
plot.new
plot.new()
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = beg, to = end)
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
plot(main = 'puissance théorique de N-P, puissance estimée Np (bleu), puissance estimée Wald (rouge)')
?points
?plot
title(main = 'Puissance théorique de Neyman-Pearson (noir)')
?title
title(sub = 'Puissance estimée de Neyman-Pearson(bleu), de Wald (rouge)')
title(xlab = 'tau')
plot.default
plot.default()
plot.new()
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = beg, to = end)
?curve
curve(pgamma((x/Tau_0)*q_ga, shape = 50, scale = 1), from = beg, to = end, xlab = 'tau')
n = 5
curve(pgamma((x/Tau_0)*q_ga, shape = n, scale = 1), from = beg, to = end, xlab = 'tau', ylab = 'Puissance')
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
n = 5
q_ga = qgamma(alpha, shape = n, scale = 1)
curve(pgamma((x/Tau_0)*q_ga, shape = n, scale = 1), from = beg, to = end, xlab = 'tau', ylab = 'Puissance')
for (i in 0:N) {
points(x = beg + (i*schritt), y = sim_p_ga(Tau_0, beg+(i*schritt), n, B, alpha), col = 'blue')
points(x = beg + (i*schritt), y = sim_p_norm(Tau_0, beg+(i*schritt), n, B, alpha), col = 'red')
}
?qnorm
1 - pnorm(q = 6, mean = 0, sd = 1)
2*(1 - pnorm(q = 5, mean = 0, sd = 1))
2*(1 - pnorm(q = 4, mean = 0, sd = 1))
qstudent ?
?qstudent
install.packages("irace")
library("irace")
system.file(package = "irace")
?pmax
t = c(1:100)
X1 = rnorm(100, 0, 1)
X2 = t + X1
X3 = t + cos(2*pi*t/10) + X1
X3
pX1 = HoltWinters(X2, alpha=NULL, beta=NULL, gamma=NULL, seasonal=c("additive"),
start.periods=2, l.start=NULL, b.start=NULL, s.start=NULL,
optim.start=c(alpha=0.3,beta=0.1,gamma=0.0),
optim.control=list())
pX1 = HoltWinters(X2, alpha=NULL, beta=NULL, gamma=NULL, seasonal=NULL,
start.periods=2, l.start=NULL, b.start=NULL, s.start=NULL,
optim.start=c(alpha=0.3,beta=0.1,gamma=0.0),
optim.control=list())
library("xts")
test = ts(X2)
pX2 = HoltWinters(test, alpha=NULL, beta=NULL, gamma=NULL, seasonal=c("additive"),
start.periods=2, l.start=NULL, b.start=NULL, s.start=NULL,
optim.start=c(alpha=0.3,beta=0.1,gamma=0.0),
optim.control=list())
install.packages("forecast")
library("forecast")
library("forecast")
expSmooth=function(x, alpha) {
xsmooth = x
for (i in c(2:length(xsmooth))) {
xsmooth[i] = alpha*x[i] + (1-alpha)*xsmooth[i-1]
}
return(xsmooth)
}
pX1 = expSmooth(X1, 0.3)
plot(X1, col="blue")
lines(pX1, col="red")
plot(X1, col="blue", type="l")
lines(pX1, col="red", type="l")
pX1 = expSmooth(X1, 0.1)
plot(X1, col="blue", type="l")
lines(pX1, col="red", type="l")
?lines
error = mean(X1_hat - X1_test)
X1_hat = head(pX1, n-1)
X1_test = tail(X1, n-1)
n = 100
X1_hat = head(pX1, n-1)
X1_test = tail(X1, n-1)
error = mean(X1_hat - X1_test)
sq_error = mean((X1_hat - X1_test)^2)
###########
alpha <-seq(10^-5,0.95,length=100)
forecast<-lapply(alpha,expSmooth,x=X1)
str(forecast)
erreur<-unlist(
lapply(forecast,
function(x){mean((tail(X1,n-1)-head(x,n-1))^2)}))
plot(alpha,erreur,type='l')
X1.smooth<-expSmooth(X1,alpha[which.min(erreur)])
alpha[which.min(erreur)]
plot(X1,type='l')
lines(X1.smooth,col='red')
?unlist
?ones
??ones
?c
c(1:5, 7)
c(7, 1:5)
c(2,2)
c(2,67)
rep(5, 20)
c_HW=function(x, alpha, beta) {
l = 0
b = 0
lfor = x[0]
bfor = 0
xhat = x
for (i in c(2:length(x))) {
l = alpha*x[i] + (1-alpha)*(lfor + bfor)
b = beta*(l-lfor) + (1-beta)*bfor
xhat[i] = l+b
lfor = l
bfor = b
}
return(xhat)
}
doubleExpSmooth=function(x, alpha) {
if (alpha == 0) {
return(rep(x[0],length(x)))
}
return(c_HW(x, 1-(1-alpha)^2, (alpha^2)/(1-(1-alpha)^2) )  )
}
alpha = 0.2
pX2 = doubleExpSmooth(X2, alpha)
X2
c_HW=function(x, alpha, beta) {
l = 0
b = 0
lfor = x[1]
bfor = 0
xhat = x
for (i in c(2:length(x))) {
l = alpha*x[i] + (1-alpha)*(lfor + bfor)
b = beta*(l-lfor) + (1-beta)*bfor
xhat[i] = l+b
lfor = l
bfor = b
}
return(xhat)
}
doubleExpSmooth=function(x, alpha) {
if (alpha == 0) {
return(rep(x[0],length(x)))
}
return(c_HW(x, 1-(1-alpha)^2, (alpha^2)/(1-(1-alpha)^2) )  )
}
alpha = 0.2
pX2 = doubleExpSmooth(X2, alpha)
plot(X2, col = "blue", type = "l")
lines(pX2, col="red", type = "l")
alpha = 0.05
pX2 = doubleExpSmooth(X2, alpha)
plot(X2, col = "blue", type = "l")
lines(pX2, col="red", type = "l")
alpha = 0.95
pX2 = doubleExpSmooth(X2, alpha)
plot(X2, col = "blue", type = "l")
lines(pX2, col="red", type = "l")
lalpha = seq(0,1,length=101)
lpX2 = lapply(lalpha,doubleExpSmooth,x=X2)
error = unlist(lapply(lpX2,err))
err=function(x,xhat) {
return(mean((xhat-x)^2))
}
error = unlist(lapply(lpX2,err))
?head
test = c(1:5)
head(test,4)
error = unlist(lapply(X2_hat,err,x=tail(X2,n-1)))
lpX2 = lapply(lalpha,doubleExpSmooth,x=X2)
X2_hat = lapply(lpX2,head,n=n-1)
error = unlist(lapply(X2_hat,err,x=tail(X2,n-1)))
alpha_opt = lalpha[which.min(error)]
plot(error, type="l")
plot(X2, col = "blue", type = "l")
lines(doubleExpSmooth(X2, alpha_opt), col = "red", type = "l")
plot(error, type="l")
plot(lalpha, error, type="l")
lalpha = seq(0.1,1,length=101)
lpX2 = lapply(lalpha,doubleExpSmooth,x=X2)
X2_hat = lapply(lpX2,head,n=n-1)
error = unlist(lapply(X2_hat,err,x=tail(X2,n-1)))
alpha_opt = lalpha[which.min(error)]
plot(lalpha, error, type="l")
plot(X2, col = "blue", type = "l")
lines(doubleExpSmooth(X2, alpha_opt), col = "red", type = "l")
alpha_opt
setwd("~/Documents/ENSTA/Cours/2A/STA202/Projet/BDD/")
tFun=function(x) {
#print(x$an)
print(x)
print("\r")
}
unpackk=function(dat) {
annee = paste("20", as.character(dat$an), sep="")
str_date = paste(as.character(dat$jour),as.character(dat$mois),annee,sep="/")
#date_format = strptime(dat_date, format="%d/%m/%Y")
str_time = as.character(dat$hrmn)
str_min = substr(str_time, nchar(str_time)-1, nchar(str_time))
str_hour = substr(str_time, nchar(str_time)-3, nchar(str_time)-2)
str_t_format = paste(str_hour, str_min, sep=":")
str_datetime = paste(str_date, str_t_format, sep=" ")
data_datetime = strptime(str_datetime, format="%d/%m/%Y %H:%M", tz="CEST")
dat$date = data_datetime
return(dat)
}
data_2017 = read.csv("caracteristiques-2017.csv")
acc_2017 = unpackk(data_2017)
head(acc_2017, 10)
data_2005 = read.csv("caracteristiques_2005.csv")
head(data_2005)
data_2005 = read.csv("caracteristiques_2005.csv")
data_2006 = read.csv("caracteristiques_2006.csv")
data_2007 = read.csv("caracteristiques_2007.csv")
data_2008 = read.csv("caracteristiques_2008.csv")
data_2009 = read.csv("caracteristiques_2009.csv")
data_2010 = read.csv("caracteristiques_2010.csv")
data_2011 = read.csv("caracteristiques_2011.csv")
data_2012 = read.csv("caracteristiques_2012.csv")
data_2013 = read.csv("caracteristiques_2013.csv")
data_2014 = read.csv("caracteristiques_2014.csv")
data_2015 = read.csv("caracteristiques_2015.csv")
data_2016 = read.csv("caracteristiques_2016.csv")
data_2017 = read.csv("caracteristiques-2017.csv")
data_2018 = read.csv("caracteristiques-2018.csv")
data_2019 = read.csv("caracteristiques-2019.csv")
data_2020 = read.csv("caracteristiques-2020.csv")
curr_dat = rbind(data_2005, data_2006, data_2007, data_2008, data_2009)
curr_dat = rbind(curr_dat, data_2010, data_2011, data_2012, data_2013)
curr_dat = rbind(curr_dat, data_2014, data_2015, data_2016, data_2017)
curr_dat = rbind(curr_dat, data_2018, data_2019, data_2020)
curr_dat = rbind(data_2005, data_2006)
curr_dat = rbind(data_2005, data_2006, data_2007)
curr_dat = rbind(data_2005, data_2006, data_2007, data_2008)
curr_dat = rbind(data_2005, data_2006, data_2007, data_2008, data_2009)
head(data_2009)
?read.csv
data_2009 = read.delim2("caracteristiques_2009.csv")
head(data_2009)
data_2010 = read.csv("caracteristiques_2010.csv")
head(data_2010)
curr_dat = rbind(data_2005, data_2006, data_2007, data_2008, data_2009)
curr_dat = rbind(curr_dat, data_2010, data_2011, data_2012, data_2013)
curr_dat = rbind(curr_dat, data_2014, data_2015, data_2016, data_2017)
curr_dat = rbind(curr_dat, data_2018, data_2019, data_2020)
head(data_2018)
head(data_2019)
data_2019 = read.csv2("caracteristiques-2019.csv")
head(data_2019)
curr_dat = rbind(curr_dat, data_2018, data_2019, data_2020)
head(data_2020)
data_2020 = read.csv2("caracteristiques-2020.csv")
curr_dat = rbind(curr_dat, data_2018, data_2019, data_2020)
head(data_2020)
length(data_2020)
length(data_2019)
length(data_2018)
head(data_2018)
head(data_2019)
head(data_2005)
